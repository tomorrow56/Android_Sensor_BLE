# Android Sensor BLE - M5Stack対応版

このアプリはM5Stackとの通信に最適化されたAndroidセンサーデータ送信アプリです。

## 変更点（通常版との違い）

### MTU対応のデータ分割送信
- BLE接続時にMTUサイズを追跡
- JSONデータがMTUを超える場合、自動的に分割して送信
- 最後のチャンクに終端マーカー（`\n`）を追加

### 対応する受信側の処理
M5Stack側では以下の処理が必要です：

1. 受信データをバッファに蓄積
2. 終端マーカー（`\n`）を検出したら完全なJSONとしてパース
3. ArduinoJsonでデシリアライズ

## 使用方法

1. このフォルダをAndroid Studioで開く
2. ビルドしてAndroidデバイスにインストール
3. M5Stackで`examples/M5_BLE_Rcv_Test`スケッチを実行
4. アプリを起動してデータ送信を開始

## 技術仕様

- **終端マーカー**: `\n`（改行文字）
- **チャンク間待機時間**: 20ms
- **デフォルトMTU**: 23バイト
- **ATTヘッダーサイズ**: 3バイト

## 注意事項

- M5StackがMTU 517をリクエストした場合、`onMtuChanged`コールバックで更新されます
- 送信間隔が短すぎると、チャンク送信が間に合わない場合があります
